# 🏗️ GovChat 아키텍처 개요

## 📋 프로젝트 비전

GovChat은 **정부 재정 지원사업 정보를 수집**하고 사용자에게 **맞춤 매칭**해주는 AI 챗봇 서비스입니다. 중앙정부, 지자체, 공공기관 등에서 국민·기업을 대상으로 제공하는 각종 지원사업 데이터를 한데 모아 통합 관리하며, 사용자의 상황/조건을 대화로 파악하여 **가장 적합한 사업을 찾아 추천**해주는 것이 목표입니다.

## 🎯 핵심 가치 제안

### 1. **통합 데이터 수집**
- 공공데이터 포털(data.go.kr) API 연동
- 다양한 기관의 사업정보를 표준화된 스키마로 통합
- 외부 수집 + 관리자 수동 입력 하이브리드 방식

### 2. **AI 기반 조건 추론**
- 사용자 대화에서 매칭 조건 자동 추출
- 명시된 조건뿐만 아니라 유추 가능한 조건까지 분석
- 부족한 정보는 단계적 질문으로 보완

### 3. **"원서치" 통합 검색**
- OpenSearch 기반 전문 검색 엔진
- 키워드 + 벡터 유사도 복합 검색
- 의미 기반 매칭으로 표현이 달라도 관련 정책 발견

### 4. **점진적 프로필 완성**
- 최소 정보로 가입 시작
- 대화 과정에서 프로필 자동 완성
- 개인화된 추천 정확도 지속 향상

## 🏛️ 시스템 아키텍처

```
┌─────────────────── GovChat 전체 아키텍처 ───────────────────┐
│                                                           │
│  🌐 Frontend (Next.js)                                   │
│  ├── 사용자 채팅 인터페이스                                  │
│  ├── 관리자 대시보드                                        │
│  └── 소셜 로그인 (Google, Kakao, Naver)                   │
│                                                           │
│  ┌─────────────────── AWS Cloud ─────────────────────┐   │
│  │                                                   │   │
│  │  🚪 API Gateway (REST + CORS)                    │   │
│  │  ├── /chat      → ChatbotLambda                  │   │
│  │  ├── /search    → SearchLambda                   │   │
│  │  ├── /match     → MatchLambda                    │   │
│  │  ├── /extract   → ExtractLambda                  │   │
│  │  ├── /policies  → PolicyLambda                   │   │
│  │  ├── /auth      → UserAuthLambda                 │   │
│  │  ├── /admin     → AdminAuthLambda                │   │
│  │  └── /profile   → UserProfileLambda              │   │
│  │                                                   │   │
│  │  🧠 AI Processing Layer                          │   │
│  │  ├── GPT-4 Mini (대화 및 조건 추출)                │   │
│  │  ├── OpenAI Embeddings (벡터 임베딩)              │   │
│  │  └── 하이브리드 매칭 전략                           │   │
│  │                                                   │   │
│  │  🔍 Search & Analytics                           │   │
│  │  ├── OpenSearch Serverless                      │   │
│  │  │   ├── 전문 검색 (Full-text)                   │   │
│  │  │   ├── 벡터 검색 (Semantic)                    │   │
│  │  │   └── 클러스터링 & 분류                        │   │
│  │  │                                               │   │
│  │  🗄️ Data Layer                                   │   │
│  │  ├── DynamoDB Tables                            │   │
│  │  │   ├── PoliciesTable (정책 데이터)              │   │
│  │  │   ├── UserTable (사용자 정보)                  │   │
│  │  │   ├── UserProfileTable (프로필)               │   │
│  │  │   └── govchat-cache-v3 (캐시)                │   │
│  │  │                                               │   │
│  │  🪣 Storage                                      │   │
│  │  ├── S3 Buckets                                 │   │
│  │  │   ├── govchat-data-v3 (메인 데이터)           │   │
│  │  │   ├── gov-api-raw-data (원본 API 데이터)      │   │
│  │  │   └── gov-api-processed-data (처리된 데이터)   │   │
│  │  │                                               │   │
│  │  🔐 Security & Monitoring                       │   │
│  │  ├── KMS 암호화 (DynamoDB, S3)                  │   │
│  │  ├── X-Ray 분산 추적                             │   │
│  │  ├── CloudWatch 로그 & 메트릭                    │   │
│  │  └── SNS 알람 시스템                             │   │
│  └───────────────────────────────────────────────────┘   │
│                                                           │
│  🔌 External Integrations                                │
│  ├── 공공데이터 포털 API (data.go.kr)                      │
│  ├── 소셜 로그인 OAuth                                     │
│  └── 실명 인증 API (향후 연동 예정)                         │
└───────────────────────────────────────────────────────────┘
```

## 🔄 데이터 처리 파이프라인

### 1. **데이터 수집 단계**
```
공공데이터 API → 스키마 정규화 → 중복 제거 → 임베딩 생성 → OpenSearch 인덱싱
```

### 2. **사용자 매칭 단계**
```
사용자 질문 → 조건 추출 → 벡터 검색 → 규칙 필터링 → AI 점수 산출 → 결과 제시
```

### 3. **프로필 학습 단계**
```
대화 분석 → 조건 추론 → 프로필 업데이트 → 개인화 강화 → 추천 정확도 향상
```

## 🧩 주요 컴포넌트

### Frontend (Next.js)
- **사용자 인터페이스**: 채팅, 검색, 마이페이지
- **관리자 대시보드**: 정책 관리, 사용자 관리, 시스템 설정
- **인증 시스템**: NextAuth.js 기반 다중 OAuth

### Backend (AWS Lambda)
- **ChatbotLambda**: GPT-4 Mini 기반 대화 처리
- **SearchLambda**: OpenSearch 통합 검색
- **MatchLambda**: 사용자-정책 매칭 로직
- **ExtractLambda**: 보도자료 자동 정보 추출
- **PolicyLambda**: 정책 CRUD 및 동기화

### Data Storage
- **DynamoDB**: 구조화된 데이터 저장
- **OpenSearch**: 검색 및 분석 엔진
- **S3**: 대용량 파일 및 백업 저장

### AI/ML Components
- **GPT-4 Mini**: 자연어 이해 및 생성
- **OpenAI Embeddings**: 의미 벡터 생성
- **클러스터링**: 유사 정책 그룹화

## 🔒 보안 아키텍처

### 인증 및 권한
- **JWT 기반 세션 관리**
- **역할 기반 접근 제어 (RBAC)**
- **소셜 로그인 OAuth 2.0**

### 데이터 보호
- **KMS 암호화**: 저장 데이터 암호화
- **HTTPS/TLS**: 전송 중 암호화
- **최소 권한 원칙**: IAM 정책 적용

### 모니터링
- **X-Ray 분산 추적**
- **CloudWatch 로그 분석**
- **실시간 알람 시스템**

## 📊 성능 최적화

### 캐싱 전략
- **DynamoDB 캐시**: 매칭 결과 캐싱
- **OpenSearch 캐시**: 검색 결과 캐싱
- **Lambda 메모리 최적화**: 함수별 맞춤 설정

### 확장성
- **서버리스 아키텍처**: 자동 스케일링
- **비동기 처리**: 대용량 데이터 처리
- **파티션 키 분산**: 핫 파티션 방지

## 🎯 향후 발전 방향

### 단기 목표 (3개월)
- AI 매칭 정확도 90% 달성
- 소셜 로그인 완전 구현
- 관리자 대시보드 고도화

### 중기 목표 (6개월)
- 실명 인증 연동
- 모바일 앱 출시
- 다국어 지원

### 장기 목표 (1년)
- 지자체별 특화 서비스
- 기업 대상 B2B 확장
- AI 모델 자체 개발

---

**아키텍처 설계**: 서버리스 우선, 확장 가능, 보안 중심  
**기술 철학**: 사용자 중심, 데이터 기반, AI 활용  
**최종 목표**: 정부 지원정책 접근성 혁신